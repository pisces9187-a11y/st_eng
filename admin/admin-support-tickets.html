<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Support Tickets - Admin Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght=600;700;800&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 260px;
            background: linear-gradient(135deg, #183B56 0%, #0F2233 100%);
            color: white;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 4px 0 12px rgba(0,0,0,0.15);
        }

        .sidebar-header {
            padding: 24px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-header h4 {
            color: #F47C26;
            font-size: 18px;
            font-weight: 800;
        }

        .nav-section {
            padding: 16px 0;
        }

        .nav-section-title {
            padding: 0 20px;
            font-size: 11px;
            text-transform: uppercase;
            color: rgba(255,255,255,0.5);
            font-weight: 600;
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s;
            font-size: 14px;
        }

        .nav-link:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            padding-left: 28px;
        }

        .nav-link.active {
            background: linear-gradient(90deg, rgba(244,124,38,0.2) 0%, transparent 100%);
            color: #F47C26;
            border-left: 3px solid #F47C26;
        }

        .nav-link i {
            width: 24px;
            margin-right: 12px;
            font-size: 16px;
        }

        /* Main Content */
        .main-content {
            margin-left: 260px;
            padding: 32px;
        }

        .top-bar {
            background: white;
            padding: 20px 32px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .page-title {
            font-size: 28px;
            color: #183B56;
            font-weight: 800;
        }

        .admin-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .admin-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #F47C26, #FF9A56);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
        }

        /* Stats Cards */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-left: 4px solid;
        }

        .stat-card.danger { border-color: #E74C3C; }
        .stat-card.warning { border-color: #F39C12; }
        .stat-card.success { border-color: #2ECC71; }
        .stat-card.info { border-color: #3498DB; }
        .stat-card.primary { border-color: #F47C26; }

        .stat-value {
            font-size: 32px;
            font-weight: 800;
            color: #183B56;
            margin-bottom: 4px;
        }

        .stat-label {
            color: #7F8C8D;
            font-size: 14px;
        }

        /* Content Card */
        .content-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            overflow: hidden;
            margin-bottom: 24px;
        }

        .card-header {
            padding: 20px 24px;
            border-bottom: 1px solid #ECF0F1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 18px;
            color: #183B56;
            font-weight: 700;
        }

        .card-body {
            padding: 24px;
        }

        /* Filter Bar */
        .filter-bar {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-btn {
            padding: 10px 20px;
            border: 2px solid #ECF0F1;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            color: #7F8C8D;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-btn:hover,
        .filter-btn.active {
            border-color: #F47C26;
            background: #F47C26;
            color: white;
        }

        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 10px 16px 10px 40px;
            border: 2px solid #ECF0F1;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #F47C26;
        }

        .search-box i {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: #7F8C8D;
        }

        /* Ticket List */
        .ticket-item {
            background: #F9FAFC;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            border-left: 4px solid;
            display: flex;
            justify-content: space-between;
            align-items: start;
            transition: all 0.3s;
            cursor: pointer;
        }

        .ticket-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transform: translateX(4px);
        }

        .ticket-item.critical { border-color: #E74C3C; }
        .ticket-item.high { border-color: #F39C12; }
        .ticket-item.medium { border-color: #3498DB; }
        .ticket-item.low { border-color: #95A5A6; }

        .ticket-content {
            flex: 1;
        }

        .ticket-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }

        .ticket-id {
            font-family: 'Courier New', monospace;
            font-weight: 700;
            color: #7F8C8D;
            font-size: 13px;
        }

        .ticket-priority {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .priority-critical { background: rgba(231,76,60,0.1); color: #E74C3C; }
        .priority-high { background: rgba(243,156,18,0.1); color: #F39C12; }
        .priority-medium { background: rgba(52,152,219,0.1); color: #3498DB; }
        .priority-low { background: rgba(149,165,166,0.1); color: #95A5A6; }

        .ticket-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-open { background: rgba(231,76,60,0.1); color: #E74C3C; }
        .status-in-progress { background: rgba(241,196,15,0.1); color: #F39C12; }
        .status-waiting { background: rgba(52,152,219,0.1); color: #3498DB; }
        .status-resolved { background: rgba(46,204,113,0.1); color: #2ECC71; }
        .status-closed { background: rgba(149,165,166,0.1); color: #95A5A6; }

        .ticket-title {
            font-size: 16px;
            font-weight: 700;
            color: #183B56;
            margin-bottom: 4px;
        }

        .ticket-meta {
            display: flex;
            gap: 16px;
            color: #7F8C8D;
            font-size: 13px;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        .ticket-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .ticket-actions {
            display: flex;
            gap: 8px;
        }

        .btn-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            color: #7F8C8D;
        }

        .btn-icon:hover {
            background: #F47C26;
            color: white;
            transform: scale(1.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #F47C26 0%, #FF9A56 100%);
            border: none;
            padding: 10px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(244,124,38,0.4);
        }

        .btn-secondary {
            background: #ECF0F1;
            color: #183B56;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
        }

        .btn-secondary:hover {
            background: #BDC3C7;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid #ECF0F1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 800;
            color: #183B56;
        }

        .close-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: #ECF0F1;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .close-btn:hover {
            background: #F47C26;
            color: white;
        }

        .modal-body {
            padding: 24px;
        }

        .ticket-detail {
            margin-bottom: 24px;
        }

        .detail-section {
            background: #F9FAFC;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .detail-label {
            font-size: 12px;
            text-transform: uppercase;
            color: #7F8C8D;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .detail-value {
            color: #183B56;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #183B56;
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #ECF0F1;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #F47C26;
        }

        textarea.form-control {
            resize: vertical;
            min-height: 120px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .modal-footer {
            padding: 20px 24px;
            border-top: 1px solid #ECF0F1;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Conversation Thread */
        .conversation {
            margin-top: 24px;
        }

        .message {
            margin-bottom: 16px;
            display: flex;
            gap: 12px;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #F47C26, #FF9A56);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 14px;
            flex-shrink: 0;
        }

        .message-avatar.customer {
            background: linear-gradient(135deg, #3498DB, #5DADE2);
        }

        .message-content {
            flex: 1;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }

        .message-author {
            font-weight: 700;
            color: #183B56;
        }

        .message-time {
            font-size: 12px;
            color: #7F8C8D;
        }

        .message-text {
            background: #F9FAFC;
            padding: 12px 16px;
            border-radius: 8px;
            color: #2C3E50;
            line-height: 1.6;
        }

        /* Response Templates */
        .template-list {
            display: grid;
            gap: 8px;
            margin-bottom: 16px;
        }

        .template-item {
            padding: 12px;
            background: #F9FAFC;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .template-item:hover {
            background: #ECF0F1;
            border-color: #F47C26;
        }

        .template-title {
            font-weight: 600;
            color: #183B56;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .template-preview {
            font-size: 12px;
            color: #7F8C8D;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h4><i class="fas fa-graduation-cap"></i> ADMIN PANEL</h4>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">Dashboard</div>
                <a href="admin-dashboard.html" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>Tổng Quan</span>
                </a>
                <a href="admin-analytics.html" class="nav-link">
                    <i class="fas fa-chart-line"></i>
                    <span>Phân Tích</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Nội Dung</div>
                <a href="admin-lesson-editor.html" class="nav-link">
                    <i class="fas fa-book"></i>
                    <span>Bài Học</span>
                </a>
                <a href="admin-flashcard.html" class="nav-link">
                    <i class="fas fa-layer-group"></i>
                    <span>Flashcards</span>
                </a>
                <a href="admin-questions.html" class="nav-link">
                    <i class="fas fa-question-circle"></i>
                    <span>Câu Hỏi</span>
                </a>
                <a href="admin-assessments.html" class="nav-link">
                    <i class="fas fa-file-alt"></i>
                    <span>Bài Kiểm Tra</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Người Dùng</div>
                <a href="admin-users.html" class="nav-link">
                    <i class="fas fa-users"></i>
                    <span>Học Viên</span>
                </a>
                <a href="admin-teachers.html" class="nav-link">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <span>Giáo Viên</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Tài Chính</div>
                <a href="admin-revenue.html" class="nav-link">
                    <i class="fas fa-dollar-sign"></i>
                    <span>Doanh Thu</span>
                </a>
                <a href="admin-coupons.html" class="nav-link">
                    <i class="fas fa-ticket-alt"></i>
                    <span>Mã Giảm Giá</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Marketing</div>
                <a href="admin-email-campaigns.html" class="nav-link">
                    <i class="fas fa-envelope"></i>
                    <span>Email Campaigns</span>
                </a>
                <a href="admin-notifications.html" class="nav-link">
                    <i class="fas fa-bell"></i>
                    <span>Thông Báo</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Hỗ Trợ</div>
                <a href="admin-support-tickets.html" class="nav-link active">
                    <i class="fas fa-ticket-alt"></i>
                    <span>Support Tickets</span>
                </a>
                <a href="admin-reports.html" class="nav-link">
                    <i class="fas fa-chart-bar"></i>
                    <span>Báo Cáo</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Hệ Thống</div>
                <a href="admin-settings.html" class="nav-link">
                    <i class="fas fa-cog"></i>
                    <span>Cài Đặt</span>
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Bar -->
            <div class="top-bar">
                <h1 class="page-title">
                    <i class="fas fa-ticket-alt"></i> Support Tickets
                </h1>
                <div class="admin-info">
                    <div class="admin-avatar">AD</div>
                    <div>
                        <div style="font-weight: 700; color: #183B56;">Admin</div>
                        <div style="font-size: 12px; color: #7F8C8D;">Super Admin</div>
                    </div>
                </div>
            </div>

            <!-- Stats Row -->
            <div class="stats-row">
                <div class="stat-card danger">
                    <div class="stat-value">{{ stats.open }}</div>
                    <div class="stat-label">Mới / Chưa Xử Lý</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-value">{{ stats.inProgress }}</div>
                    <div class="stat-label">Đang Xử Lý</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-value">{{ stats.resolved }}</div>
                    <div class="stat-label">Đã Giải Quyết</div>
                </div>
                <div class="stat-card info">
                    <div class="stat-value">{{ stats.avgResponseTime }}h</div>
                    <div class="stat-label">Thời Gian Phản Hồi TB</div>
                </div>
                <div class="stat-card primary">
                    <div class="stat-value">{{ stats.satisfaction }}%</div>
                    <div class="stat-label">Mức Độ Hài Lòng</div>
                </div>
            </div>

            <!-- Content Card -->
            <div class="content-card">
                <div class="card-header">
                    <h2 class="card-title">Danh Sách Tickets</h2>
                </div>
                <div class="card-body">
                    <!-- Filter Bar -->
                    <div class="filter-bar">
                        <button class="filter-btn" :class="{active: filterStatus === 'all'}" @click="filterStatus = 'all'">
                            Tất Cả ({{ tickets.length }})
                        </button>
                        <button class="filter-btn" :class="{active: filterStatus === 'open'}" @click="filterStatus = 'open'">
                            <i class="fas fa-inbox"></i> Mới
                        </button>
                        <button class="filter-btn" :class="{active: filterStatus === 'in-progress'}" @click="filterStatus = 'in-progress'">
                            <i class="fas fa-spinner"></i> Đang Xử Lý
                        </button>
                        <button class="filter-btn" :class="{active: filterStatus === 'waiting'}" @click="filterStatus = 'waiting'">
                            <i class="fas fa-clock"></i> Chờ Phản Hồi
                        </button>
                        <button class="filter-btn" :class="{active: filterStatus === 'resolved'}" @click="filterStatus = 'resolved'">
                            <i class="fas fa-check"></i> Đã Giải Quyết
                        </button>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" v-model="searchQuery" placeholder="Tìm kiếm theo ID, tiêu đề, email...">
                        </div>
                    </div>

                    <!-- Ticket List -->
                    <div v-for="ticket in filteredTickets" :key="ticket.id" 
                         :class="['ticket-item', ticket.priority]"
                         @click="viewTicket(ticket)">
                        <div class="ticket-content">
                            <div class="ticket-header">
                                <span class="ticket-id">#{{ ticket.id }}</span>
                                <span :class="['ticket-priority', 'priority-' + ticket.priority]">
                                    {{ getPriorityText(ticket.priority) }}
                                </span>
                                <span :class="['ticket-status', 'status-' + ticket.status]">
                                    {{ getStatusText(ticket.status) }}
                                </span>
                            </div>
                            <div class="ticket-title">{{ ticket.subject }}</div>
                            <div style="color: #7F8C8D; margin-top: 4px;">{{ ticket.preview }}</div>
                            <div class="ticket-meta">
                                <span>
                                    <i class="fas fa-user"></i>
                                    {{ ticket.customerName }}
                                </span>
                                <span>
                                    <i class="fas fa-envelope"></i>
                                    {{ ticket.customerEmail }}
                                </span>
                                <span>
                                    <i class="fas fa-clock"></i>
                                    {{ ticket.createdAt }}
                                </span>
                                <span v-if="ticket.assignedTo">
                                    <i class="fas fa-user-tag"></i>
                                    {{ ticket.assignedTo }}
                                </span>
                            </div>
                        </div>
                        <div class="ticket-actions" @click.stop>
                            <button class="btn-icon" @click="viewTicket(ticket)" title="Xem chi tiết">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div v-if="filteredTickets.length === 0" style="text-align: center; padding: 60px; color: #7F8C8D;">
                        <i class="fas fa-inbox" style="font-size: 64px; margin-bottom: 16px; opacity: 0.3;"></i>
                        <div style="font-size: 18px; font-weight: 600;">Không có ticket nào</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Ticket Detail -->
        <div class="modal-overlay" :class="{active: showModal}" @click.self="closeModal">
            <div class="modal-content" v-if="selectedTicket">
                <div class="modal-header">
                    <h3 class="modal-title">
                        Ticket #{{ selectedTicket.id }} - {{ selectedTicket.subject }}
                    </h3>
                    <button class="close-btn" @click="closeModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Ticket Details -->
                    <div class="ticket-detail">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                            <div class="detail-section">
                                <div class="detail-label">Trạng Thái</div>
                                <select class="form-control" v-model="selectedTicket.status">
                                    <option value="open">Mới</option>
                                    <option value="in-progress">Đang Xử Lý</option>
                                    <option value="waiting">Chờ Phản Hồi</option>
                                    <option value="resolved">Đã Giải Quyết</option>
                                    <option value="closed">Đã Đóng</option>
                                </select>
                            </div>
                            <div class="detail-section">
                                <div class="detail-label">Độ Ưu Tiên</div>
                                <select class="form-control" v-model="selectedTicket.priority">
                                    <option value="low">Thấp</option>
                                    <option value="medium">Trung Bình</option>
                                    <option value="high">Cao</option>
                                    <option value="critical">Khẩn Cấp</option>
                                </select>
                            </div>
                            <div class="detail-section">
                                <div class="detail-label">Phân Công</div>
                                <select class="form-control" v-model="selectedTicket.assignedTo">
                                    <option value="">Chưa phân công</option>
                                    <option value="Admin Hà">Admin Hà</option>
                                    <option value="Admin Minh">Admin Minh</option>
                                    <option value="Admin Linh">Admin Linh</option>
                                </select>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px;">
                            <div class="detail-section">
                                <div class="detail-label">Khách Hàng</div>
                                <div class="detail-value">{{ selectedTicket.customerName }}</div>
                                <div style="font-size: 13px; color: #7F8C8D; margin-top: 4px;">
                                    {{ selectedTicket.customerEmail }}
                                </div>
                            </div>
                            <div class="detail-section">
                                <div class="detail-label">Thời Gian</div>
                                <div class="detail-value">{{ selectedTicket.createdAt }}</div>
                                <div style="font-size: 13px; color: #7F8C8D; margin-top: 4px;">
                                    Cập nhật: {{ selectedTicket.updatedAt }}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Conversation -->
                    <div class="conversation">
                        <h4 style="margin-bottom: 16px; color: #183B56;">Lịch Sử Trao Đổi</h4>
                        
                        <div class="message">
                            <div class="message-avatar customer">{{ selectedTicket.customerName.charAt(0) }}</div>
                            <div class="message-content">
                                <div class="message-header">
                                    <span class="message-author">{{ selectedTicket.customerName }}</span>
                                    <span class="message-time">{{ selectedTicket.createdAt }}</span>
                                </div>
                                <div class="message-text">{{ selectedTicket.fullMessage }}</div>
                            </div>
                        </div>

                        <div v-for="reply in selectedTicket.replies" :key="reply.id" class="message">
                            <div class="message-avatar" :class="{customer: reply.isCustomer}">
                                {{ reply.author.charAt(0) }}
                            </div>
                            <div class="message-content">
                                <div class="message-header">
                                    <span class="message-author">{{ reply.author }}</span>
                                    <span class="message-time">{{ reply.time }}</span>
                                </div>
                                <div class="message-text">{{ reply.message }}</div>
                            </div>
                        </div>
                    </div>

                    <!-- Response Templates -->
                    <div style="margin-top: 24px;">
                        <h4 style="margin-bottom: 12px; color: #183B56;">Mẫu Trả Lời Nhanh</h4>
                        <div class="template-list">
                            <div class="template-item" @click="useTemplate(template)" v-for="template in templates" :key="template.id">
                                <div class="template-title">{{ template.title }}</div>
                                <div class="template-preview">{{ template.content.substring(0, 60) }}...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Reply Form -->
                    <div class="form-group">
                        <label class="form-label">Trả Lời Khách Hàng</label>
                        <textarea class="form-control" v-model="replyMessage" 
                                  placeholder="Nhập câu trả lời..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" @click="closeModal">Đóng</button>
                    <button class="btn-primary" @click="sendReply">
                        <i class="fas fa-paper-plane"></i> Gửi Phản Hồi
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    stats: {
                        open: 12,
                        inProgress: 8,
                        resolved: 156,
                        avgResponseTime: 2.5,
                        satisfaction: 94
                    },
                    filterStatus: 'all',
                    searchQuery: '',
                    showModal: false,
                    selectedTicket: null,
                    replyMessage: '',
                    templates: [
                        {
                            id: 1,
                            title: 'Xác nhận đã nhận',
                            content: 'Xin chào! Cảm ơn bạn đã liên hệ. Chúng tôi đã nhận được yêu cầu của bạn và sẽ phản hồi trong thời gian sớm nhất.'
                        },
                        {
                            id: 2,
                            title: 'Hướng dẫn reset mật khẩu',
                            content: 'Để reset mật khẩu, bạn vui lòng truy cập trang Forgot Password, nhập email đã đăng ký và làm theo hướng dẫn trong email được gửi đến.'
                        },
                        {
                            id: 3,
                            title: 'Hướng dẫn thanh toán',
                            content: 'Chúng tôi hỗ trợ các hình thức thanh toán: VietQR, Momo, và thẻ quốc tế qua Stripe. Vui lòng chọn phương thức phù hợp tại trang Checkout.'
                        },
                        {
                            id: 4,
                            title: 'Xác nhận đã giải quyết',
                            content: 'Vấn đề của bạn đã được giải quyết. Nếu còn thắc mắc, vui lòng liên hệ lại với chúng tôi. Cảm ơn bạn!'
                        }
                    ],
                    tickets: [
                        {
                            id: 'TK001',
                            priority: 'critical',
                            status: 'open',
                            subject: 'Không thể thanh toán qua VietQR',
                            preview: 'Tôi đã quét mã QR nhưng không thấy giao dịch được xác nhận...',
                            fullMessage: 'Tôi đã quét mã QR và chuyển khoản thành công nhưng sau 30 phút vẫn không thấy giao dịch được xác nhận. Mã giao dịch: VQR123456789. Vui lòng kiểm tra giúp tôi.',
                            customerName: 'Nguyễn Văn A',
                            customerEmail: 'nguyenvana@email.com',
                            createdAt: '2025-01-15 09:30',
                            updatedAt: '2025-01-15 09:30',
                            assignedTo: '',
                            replies: []
                        },
                        {
                            id: 'TK002',
                            priority: 'high',
                            status: 'in-progress',
                            subject: 'Không thể đăng nhập vào tài khoản',
                            preview: 'Tôi đã reset mật khẩu nhưng vẫn không đăng nhập được...',
                            fullMessage: 'Tôi đã reset mật khẩu theo hướng dẫn nhưng khi đăng nhập vẫn báo lỗi "Invalid credentials". Tôi đã thử nhiều lần nhưng không được.',
                            customerName: 'Trần Thị B',
                            customerEmail: 'tranthib@email.com',
                            createdAt: '2025-01-15 08:15',
                            updatedAt: '2025-01-15 10:00',
                            assignedTo: 'Admin Hà',
                            replies: [
                                {
                                    id: 1,
                                    author: 'Admin Hà',
                                    time: '2025-01-15 10:00',
                                    message: 'Xin chào! Tôi đã kiểm tra tài khoản của bạn. Vui lòng thử xóa cache trình duyệt và đăng nhập lại.',
                                    isCustomer: false
                                }
                            ]
                        },
                        {
                            id: 'TK003',
                            priority: 'medium',
                            status: 'waiting',
                            subject: 'Hỏi về chính sách hoàn tiền',
                            preview: 'Tôi muốn biết chính sách hoàn tiền trong vòng bao nhiêu ngày...',
                            fullMessage: 'Tôi muốn biết chính sách hoàn tiền của khóa học trong vòng bao nhiêu ngày? Và thủ tục như thế nào?',
                            customerName: 'Lê Văn C',
                            customerEmail: 'levanc@email.com',
                            createdAt: '2025-01-14 16:45',
                            updatedAt: '2025-01-15 09:00',
                            assignedTo: 'Admin Minh',
                            replies: [
                                {
                                    id: 1,
                                    author: 'Admin Minh',
                                    time: '2025-01-15 09:00',
                                    message: 'Chúng tôi có chính sách hoàn tiền 100% trong vòng 7 ngày đầu nếu bạn chưa hoàn thành quá 20% khóa học. Bạn có muốn hoàn tiền không?',
                                    isCustomer: false
                                }
                            ]
                        },
                        {
                            id: 'TK004',
                            priority: 'low',
                            status: 'resolved',
                            subject: 'Hướng dẫn sử dụng flashcard',
                            preview: 'Làm sao để tạo flashcard riêng của mình...',
                            fullMessage: 'Làm sao để tạo flashcard riêng của mình? Tôi muốn tạo bộ thẻ cho từ vựng chuyên ngành.',
                            customerName: 'Phạm Thị D',
                            customerEmail: 'phamthid@email.com',
                            createdAt: '2025-01-14 14:20',
                            updatedAt: '2025-01-14 15:00',
                            assignedTo: 'Admin Linh',
                            replies: [
                                {
                                    id: 1,
                                    author: 'Admin Linh',
                                    time: '2025-01-14 15:00',
                                    message: 'Bạn vào mục Flashcards > Create New Set. Sau đó thêm từng thẻ với mặt trước và mặt sau. Chúng tôi có video hướng dẫn tại: https://example.com/guide',
                                    isCustomer: false
                                },
                                {
                                    id: 2,
                                    author: 'Phạm Thị D',
                                    time: '2025-01-14 15:30',
                                    message: 'Cảm ơn! Tôi đã làm được rồi.',
                                    isCustomer: true
                                }
                            ]
                        },
                        {
                            id: 'TK005',
                            priority: 'high',
                            status: 'open',
                            subject: 'Video bài học không load được',
                            preview: 'Tôi đang học bài Lesson 15 nhưng video cứ loading mãi...',
                            fullMessage: 'Tôi đang học bài Lesson 15 Level B1 nhưng video cứ loading mãi không chạy. Internet của tôi vẫn bình thường, xem Youtube OK.',
                            customerName: 'Hoàng Văn E',
                            customerEmail: 'hoangvane@email.com',
                            createdAt: '2025-01-15 11:00',
                            updatedAt: '2025-01-15 11:00',
                            assignedTo: '',
                            replies: []
                        },
                        {
                            id: 'TK006',
                            priority: 'medium',
                            status: 'in-progress',
                            subject: 'Muốn nâng cấp gói Premium',
                            preview: 'Tôi đang dùng gói Basic và muốn nâng cấp lên Premium...',
                            fullMessage: 'Tôi đang dùng gói Basic và muốn nâng cấp lên Premium. Giá chênh lệch là bao nhiêu và có được giữ lại tiến độ không?',
                            customerName: 'Vũ Thị F',
                            customerEmail: 'vuthif@email.com',
                            createdAt: '2025-01-15 10:30',
                            updatedAt: '2025-01-15 11:15',
                            assignedTo: 'Admin Hà',
                            replies: [
                                {
                                    id: 1,
                                    author: 'Admin Hà',
                                    time: '2025-01-15 11:15',
                                    message: 'Bạn chỉ cần trả phần chênh lệch theo thời gian còn lại. Toàn bộ tiến độ học tập sẽ được giữ nguyên. Bạn có muốn tôi tính toán chi tiết không?',
                                    isCustomer: false
                                }
                            ]
                        }
                    ]
                };
            },
            computed: {
                filteredTickets() {
                    let result = this.tickets;

                    // Filter by status
                    if (this.filterStatus !== 'all') {
                        result = result.filter(t => t.status === this.filterStatus);
                    }

                    // Filter by search query
                    if (this.searchQuery.trim()) {
                        const query = this.searchQuery.toLowerCase();
                        result = result.filter(t => 
                            t.id.toLowerCase().includes(query) ||
                            t.subject.toLowerCase().includes(query) ||
                            t.customerName.toLowerCase().includes(query) ||
                            t.customerEmail.toLowerCase().includes(query)
                        );
                    }

                    return result;
                }
            },
            methods: {
                getPriorityText(priority) {
                    const map = {
                        critical: 'Khẩn Cấp',
                        high: 'Cao',
                        medium: 'Trung Bình',
                        low: 'Thấp'
                    };
                    return map[priority] || priority;
                },
                getStatusText(status) {
                    const map = {
                        open: 'Mới',
                        'in-progress': 'Đang Xử Lý',
                        waiting: 'Chờ Phản Hồi',
                        resolved: 'Đã Giải Quyết',
                        closed: 'Đã Đóng'
                    };
                    return map[status] || status;
                },
                viewTicket(ticket) {
                    this.selectedTicket = {...ticket};
                    this.replyMessage = '';
                    this.showModal = true;
                },
                closeModal() {
                    this.showModal = false;
                    this.selectedTicket = null;
                },
                useTemplate(template) {
                    this.replyMessage = template.content;
                },
                sendReply() {
                    if (!this.replyMessage.trim()) {
                        alert('Vui lòng nhập nội dung phản hồi!');
                        return;
                    }

                    const reply = {
                        id: this.selectedTicket.replies.length + 1,
                        author: 'Admin',
                        time: new Date().toISOString().slice(0, 16).replace('T', ' '),
                        message: this.replyMessage,
                        isCustomer: false
                    };

                    this.selectedTicket.replies.push(reply);
                    
                    // Update main ticket
                    const ticketIndex = this.tickets.findIndex(t => t.id === this.selectedTicket.id);
                    if (ticketIndex !== -1) {
                        this.tickets[ticketIndex].replies = this.selectedTicket.replies;
                        this.tickets[ticketIndex].updatedAt = reply.time;
                        this.tickets[ticketIndex].status = this.selectedTicket.status;
                        this.tickets[ticketIndex].priority = this.selectedTicket.priority;
                        this.tickets[ticketIndex].assignedTo = this.selectedTicket.assignedTo;
                    }

                    this.replyMessage = '';
                    alert('Đã gửi phản hồi thành công!');
                }
            }
        }).mount('#app');
    </script>
</body>
</html>