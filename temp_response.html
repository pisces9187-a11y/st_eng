
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âm bật hơi /p/ và /b/ - Phát âm IPA</title>
    <meta name="description" content="Học cách phân biệt âm vô thanh /p/ và hữu thanh /b/. Hai âm này có khẩu hình giống nhau nhưng khác nhau ở việc rung thanh quản.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/static/images/favicon.svg">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Base CSS -->
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/components.css">
    
    
<link rel="stylesheet" href="/static/css/public.css">

<style>
    :root {
        --phoneme-primary: #F47C26;
        --phoneme-secondary: #183B56;
        --phoneme-success: #2ECC71;
        --phoneme-danger: #E74C3C;
        --phoneme-warning: #F1C40F;
        --phoneme-light: #F9FAFC;
        --phoneme-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    /* Hide navbar and footer in lesson mode */
    .navbar, footer {
        display: none !important;
    }
    
    .main-content {
        padding: 0 !important;
        margin: 0 !important;
    }
    
    /* Full Screen Lesson Container */
    .lesson-container {
        min-height: 100vh;
        background: var(--phoneme-light);
        display: flex;
        flex-direction: column;
    }
    
    /* Lesson Header */
    .lesson-header {
        background: white;
        padding: 1rem 1.5rem;
        box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
    }
    
    .lesson-progress-bar {
        height: 6px;
        background: #E0E6ED;
        border-radius: 10px;
        overflow: hidden;
        flex: 1;
        margin: 0 1rem;
    }
    
    .lesson-progress-bar .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--phoneme-primary), #FF9A56);
        border-radius: 10px;
        transition: width 0.5s ease;
    }
    
    /* Main Lesson Area */
    .lesson-main {
        flex: 1;
        margin-top: 70px;
        margin-bottom: 80px;
        padding: 2rem 1rem;
        overflow-y: auto;
    }
    
    /* Screen Container */
    .screen-container {
        max-width: 800px;
        margin: 0 auto;
        display: none;
    }
    
    .screen-container.active {
        display: block;
        animation: fadeIn 0.5s ease;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    /* Lesson Footer */
    .lesson-footer {
        background: white;
        padding: 1rem 1.5rem;
        box-shadow: 0 -2px 10px rgba(0,0,0,0.08);
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 1000;
    }
    
    /* IPA Symbol Styles */
    .ipa-symbol-hero {
        font-size: 6rem;
        font-family: 'Lucida Sans Unicode', 'Segoe UI', sans-serif;
        color: var(--phoneme-secondary);
        text-align: center;
        line-height: 1;
    }
    
    .ipa-symbol-large {
        font-size: 3.5rem;
        font-family: 'Lucida Sans Unicode', 'Segoe UI', sans-serif;
        color: var(--phoneme-secondary);
    }
    
    .ipa-symbol-medium {
        font-size: 2rem;
        font-family: 'Lucida Sans Unicode', 'Segoe UI', sans-serif;
        color: var(--phoneme-primary);
    }
    
    /* Phoneme Comparison Card */
    .phoneme-compare-card {
        background: white;
        border-radius: 20px;
        padding: 2rem;
        box-shadow: 0 4px 25px rgba(0,0,0,0.1);
        text-align: center;
        transition: all 0.3s ease;
    }
    
    .phoneme-compare-card.voiceless {
        border-top: 4px solid #3498DB;
    }
    
    .phoneme-compare-card.voiced {
        border-top: 4px solid var(--phoneme-primary);
    }
    
    .phoneme-compare-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 35px rgba(0,0,0,0.15);
    }
    
    /* Audio Play Button */
    .btn-audio-play {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background: var(--phoneme-primary);
        color: white;
        border: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 1.75rem;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 20px rgba(244, 124, 38, 0.4);
    }
    
    .btn-audio-play:hover {
        transform: scale(1.1);
        background: #D35400;
    }
    
    .btn-audio-play.playing {
        animation: pulse-audio 1s infinite;
    }
    
    @keyframes pulse-audio {
        0%, 100% { transform: scale(1); box-shadow: 0 4px 20px rgba(244, 124, 38, 0.4); }
        50% { transform: scale(1.1); box-shadow: 0 6px 30px rgba(244, 124, 38, 0.6); }
    }
    
    /* Word Practice Card */
    .word-practice-card {
        background: white;
        border-radius: 16px;
        padding: 1.5rem;
        text-align: center;
        box-shadow: 0 3px 15px rgba(0,0,0,0.08);
        transition: all 0.3s ease;
        cursor: pointer;
        border: 2px solid transparent;
    }
    
    .word-practice-card:hover {
        border-color: var(--phoneme-primary);
        transform: translateY(-3px);
    }
    
    .word-practice-card.active {
        border-color: var(--phoneme-primary);
        background: rgba(244, 124, 38, 0.05);
    }
    
    .word-practice-card .word-text {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--phoneme-secondary);
    }
    
    .word-practice-card .word-ipa {
        font-size: 1.1rem;
        color: #6c757d;
        font-family: 'Lucida Sans Unicode', sans-serif;
        margin: 0.5rem 0;
    }
    
    .word-practice-card .word-ipa .highlight {
        background: rgba(244, 124, 38, 0.2);
        padding: 2px 4px;
        border-radius: 4px;
        color: var(--phoneme-primary);
    }
    
    .word-practice-card .word-meaning {
        font-size: 0.9rem;
        color: #6c757d;
    }
    
    /* Tip Box */
    .tip-box {
        background: linear-gradient(135deg, #FFF8E1 0%, #FFECB3 100%);
        border-radius: 16px;
        padding: 1.25rem 1.5rem;
        border-left: 4px solid var(--phoneme-warning);
    }
    
    .tip-box-primary {
        background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);
        border-left-color: var(--phoneme-primary);
    }
    
    .tip-box i {
        font-size: 1.5rem;
        color: var(--phoneme-warning);
    }
    
    .tip-box-primary i {
        color: var(--phoneme-primary);
    }
    
    /* Minimal Pair Challenge */
    .challenge-question {
        background: white;
        border-radius: 20px;
        padding: 2rem;
        box-shadow: 0 4px 25px rgba(0,0,0,0.1);
        text-align: center;
    }
    
    .challenge-audio-btn {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        font-size: 2.5rem;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 6px 25px rgba(102, 126, 234, 0.4);
    }
    
    .challenge-audio-btn:hover {
        transform: scale(1.1);
    }
    
    .choice-btn {
        min-width: 180px;
        padding: 1.25rem 2rem;
        font-size: 1.5rem;
        font-weight: 700;
        border-radius: 16px;
        border: 3px solid #E0E6ED;
        background: white;
        color: var(--phoneme-secondary);
        transition: all 0.3s ease;
        cursor: pointer;
    }
    
    .choice-btn:hover {
        border-color: var(--phoneme-primary);
        transform: translateY(-3px);
    }
    
    .choice-btn.selected {
        border-color: var(--phoneme-primary);
        background: rgba(244, 124, 38, 0.1);
    }
    
    .choice-btn.correct {
        border-color: var(--phoneme-success) !important;
        background: rgba(46, 204, 113, 0.15) !important;
        color: var(--phoneme-success) !important;
    }
    
    .choice-btn.incorrect {
        border-color: var(--phoneme-danger) !important;
        background: rgba(231, 76, 60, 0.15) !important;
        color: var(--phoneme-danger) !important;
    }
    
    /* Score Display */
    .score-circle {
        width: 160px;
        height: 160px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--phoneme-primary) 0%, #FF9A56 100%);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        box-shadow: 0 8px 30px rgba(244, 124, 38, 0.4);
    }
    
    .score-number {
        font-size: 3rem;
        font-weight: 800;
        line-height: 1;
    }
    
    .score-label {
        font-size: 1rem;
        opacity: 0.9;
    }
    
    /* XP Earned Animation */
    .xp-earned {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 1rem 2rem;
        border-radius: 50px;
        font-size: 1.25rem;
        font-weight: 700;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        animation: bounceIn 0.6s ease;
    }
    
    @keyframes bounceIn {
        0% { transform: scale(0); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
    }
    
    /* Tongue Twister Box */
    .tongue-twister-box {
        background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
        border-radius: 16px;
        padding: 1.5rem;
        border-left: 4px solid var(--phoneme-success);
    }
    
    .tongue-twister-text {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--phoneme-secondary);
        line-height: 1.6;
    }
    
    /* Screen Navigation Dots */
    .screen-dots {
        display: flex;
        gap: 8px;
        justify-content: center;
    }
    
    .screen-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: #E0E6ED;
        transition: all 0.3s ease;
    }
    
    .screen-dot.active {
        background: var(--phoneme-primary);
        width: 30px;
        border-radius: 5px;
    }
    
    .screen-dot.completed {
        background: var(--phoneme-success);
    }
    
    /* Responsive */
    @media (max-width: 768px) {
        .ipa-symbol-hero { font-size: 4rem; }
        .ipa-symbol-large { font-size: 2.5rem; }
        .phoneme-compare-card { padding: 1.5rem; }
        .choice-btn { 
            min-width: 140px; 
            padding: 1rem 1.5rem;
            font-size: 1.25rem;
        }
    }
</style>


</head>
<body class="">
    
<div id="app">
    <!-- Navbar -->
    
<!-- Public Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm">
    <div class="container">
        <!-- Logo -->
        <a class="navbar-brand" href="/">
            <span class="logo-text" style="font-weight:700; font-size:1.5rem;">
                <span style="color:#183B56;">English</span><span style="color:#F47C26;">Master</span>
            </span>
        </a>
        
        <!-- Mobile Toggle -->
        <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <!-- Nav Items - Menu sát phải cùng với Auth buttons -->
        <div class="collapse navbar-collapse" id="navbarMain">
            <ul class="navbar-nav ms-auto me-3">
                <li class="nav-item">
                    <a class="nav-link" href="/forum/">
                        <i class="fas fa-comments me-1"></i> Diễn đàn
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/leaderboard/">
                        <i class="fas fa-trophy me-1"></i> Xếp hạng
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/help/">
                        <i class="fas fa-question-circle me-1"></i> Hỗ trợ
                    </a>
                </li>
            </ul>
            
            <!-- Auth Buttons - Controlled by JavaScript based on JWT token -->
            <div class="navbar-auth d-flex gap-2">
                <!-- Guest State (default, hidden when logged in) -->
                <div id="navbar-guest" class="d-flex gap-2">
                    <a href="/login/" class="btn btn-outline-primary-dark">Đăng nhập</a>
                    <a href="/signup/" class="btn btn-primary-orange">Đăng ký</a>
                </div>
                
                <!-- Logged In State (hidden by default, shown when logged in) -->
                <div id="navbar-user" class="d-none d-flex gap-2 align-items-center">
                    <a href="/dashboard/" class="btn btn-outline-primary">
                        <i class="fas fa-tachometer-alt me-1"></i> Dashboard
                    </a>
                    <div class="dropdown">
                        <button class="btn btn-light dropdown-toggle d-flex align-items-center gap-2" 
                                data-bs-toggle="dropdown" id="navbar-user-dropdown">
                            <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center" 
                                 style="width:32px; height:32px; font-size:14px; font-weight:600;"
                                 id="navbar-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <span class="d-none d-md-inline" id="navbar-username">Người dùng</span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="/profile/">
                                <i class="fas fa-user me-2"></i> Hồ sơ
                            </a></li>
                            <li><a class="dropdown-item" href="/profile/settings/">
                                <i class="fas fa-cog me-2"></i> Cài đặt
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-danger" href="/logout/" id="navbar-logout">
                                <i class="fas fa-sign-out-alt me-2"></i> Đăng xuất
                            </a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</nav>

<!-- Navbar Auth State Script -->
<script>
(function() {
    // Check auth state on page load
    function checkAuthState() {
        const token = localStorage.getItem('access_token');
        // Support both 'user' and 'user_data' keys for compatibility
        const userData = localStorage.getItem('user') || localStorage.getItem('user_data');
        
        const guestNav = document.getElementById('navbar-guest');
        const userNav = document.getElementById('navbar-user');
        
        if (token && userData) {
            // User is logged in
            try {
                const user = JSON.parse(userData);
                
                // Show user nav, hide guest nav
                if (guestNav) guestNav.classList.add('d-none');
                if (userNav) {
                    userNav.classList.remove('d-none');
                    userNav.classList.add('d-flex');
                }
                
                // Update username display
                const usernameEl = document.getElementById('navbar-username');
                if (usernameEl) {
                    usernameEl.textContent = user.first_name || user.username || 'Người dùng';
                }
                
                // Update avatar with initials
                const avatarEl = document.getElementById('navbar-avatar');
                if (avatarEl && user.first_name) {
                    const initials = getInitials(user.first_name, user.last_name);
                    avatarEl.innerHTML = initials;
                }
            } catch (e) {
                console.error('Error parsing user data:', e);
                showGuestNav();
            }
        } else {
            showGuestNav();
        }
    }
    
    function showGuestNav() {
        const guestNav = document.getElementById('navbar-guest');
        const userNav = document.getElementById('navbar-user');
        
        if (guestNav) {
            guestNav.classList.remove('d-none');
            guestNav.classList.add('d-flex');
        }
        if (userNav) userNav.classList.add('d-none');
    }
    
    function getInitials(firstName, lastName) {
        let initials = '';
        if (firstName) initials += firstName.charAt(0).toUpperCase();
        if (lastName) initials += lastName.charAt(0).toUpperCase();
        return initials || 'U';
    }
    
    // Run on DOM ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', checkAuthState);
    } else {
        checkAuthState();
    }
    
    // Listen for auth state changes (custom event)
    window.addEventListener('authStateChanged', checkAuthState);
})();
</script>

    
    <!-- Flash Messages -->
    
    
    <!-- Main Content -->
    <main class="main-content">
        
<div class="lesson-container" id="lessonApp">
    <!-- Lesson Header -->
    <header class="lesson-header">
        <div class="d-flex align-items-center">
            <a href="/pronunciation/" class="btn btn-link text-muted p-0 me-3" title="Thoát bài học">
                <i class="fas fa-times fa-lg"></i>
            </a>
            
            <div class="lesson-progress-bar">
                <div class="progress-fill" :style="{ width: progressPercent + '%' }"></div>
            </div>
            
            <div class="d-flex align-items-center gap-2 ms-3">
                <span class="badge bg-warning text-dark">
                    <i class="fas fa-star me-1"></i>
                    [[ xpEarned ]] XP
                </span>
                <span class="text-muted small">[[ currentScreen ]]/5</span>
            </div>
        </div>
    </header>
    
    <!-- Lesson Main Content -->
    <main class="lesson-main">
        
        <!-- ============================================ -->
        <!-- SCREEN 1: INTRO & CONCEPT -->
        <!-- ============================================ -->
        <div class="screen-container" :class="{ active: currentScreen === 1 }">
            <div class="text-center mb-4">
                <h1 class="h3 text-muted mb-2">Phần [[ lesson.part_number ]] - Bài [[ lesson.unit_number ]]</h1>
                <h2 class="display-5 fw-bold text-primary-dark">[[ lesson.title_vi ]]</h2>
            </div>
            
            <!-- Twin Sounds Intro -->
            <div class="text-center mb-5">
                <div class="d-flex justify-content-center gap-3 mb-4 flex-wrap">
                    <div class="phoneme-compare-card voiceless flex-fill" style="max-width: 220px;">
                        <div class="ipa-symbol-large">/[[ phoneme1.ipa_symbol ]]/</div>
                        <div class="mt-2 text-muted">[[ phoneme1.vietnamese_approx ]]</div>
                        <span class="badge bg-info mt-2" v-if="phoneme1.voicing === 'voiceless'">Vô thanh</span>
                        <span class="badge bg-warning text-dark mt-2" v-else>Hữu thanh</span>
                        <button class="btn btn-audio-play mt-3" @click="playPhoneme(phoneme1)" :class="{ playing: playingPhoneme === 1 }">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                    
                    <div class="d-flex align-items-center" v-if="phoneme2 && phoneme2.ipa_symbol !== phoneme1.ipa_symbol">
                        <span class="display-4 text-muted">vs</span>
                    </div>
                    
                    <div class="phoneme-compare-card voiced flex-fill" style="max-width: 220px;" v-if="phoneme2 && phoneme2.ipa_symbol !== phoneme1.ipa_symbol">
                        <div class="ipa-symbol-large">/[[ phoneme2.ipa_symbol ]]/</div>
                        <div class="mt-2 text-muted">[[ phoneme2.vietnamese_approx ]]</div>
                        <span class="badge bg-info mt-2" v-if="phoneme2.voicing === 'voiceless'">Vô thanh</span>
                        <span class="badge bg-warning text-dark mt-2" v-else>Hữu thanh</span>
                        <button class="btn btn-audio-play mt-3" @click="playPhoneme(phoneme2)" :class="{ playing: playingPhoneme === 2 }">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
                
                <p class="lead text-muted mb-4">[[ lesson.description_vi ]]</p>
            </div>
            
            <!-- Key Concept Box -->
            <div class="tip-box tip-box-primary mb-4" v-if="phoneme2 && phoneme2.ipa_symbol !== phoneme1.ipa_symbol">
                <div class="d-flex align-items-start gap-3">
                    <i class="fas fa-lightbulb mt-1"></i>
                    <div>
                        <h5 class="fw-bold mb-2">Điểm quan trọng</h5>
                        <p class="mb-0">
                            <strong>Điểm chung:</strong> Miệng bạn làm động tác Y HỆT nhau khi phát âm hai âm này.
                        </p>
                        <p class="mb-0 mt-2">
                            <strong>Điểm khác biệt:</strong><br>
                            • <span class="text-info fw-bold">/[[ phoneme1.ipa_symbol ]]/</span>: [[ phoneme1.pronunciation_tips_vi || phoneme1.vietnamese_approx ]]<br>
                            • <span class="text-warning fw-bold">/[[ phoneme2.ipa_symbol ]]/</span>: [[ phoneme2.pronunciation_tips_vi || phoneme2.vietnamese_approx ]]
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Learning Objectives -->
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <h5 class="card-title mb-3">
                        <i class="fas fa-bullseye text-primary me-2"></i>
                        Mục tiêu bài học
                    </h5>
                    <ul class="list-unstyled mb-0">
                        <li v-for="(obj, idx) in lesson.objectives" :key="idx" class="mb-2">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            [[ obj ]]
                        </li>
                        <li class="mb-2" v-if="!lesson.objectives || lesson.objectives.length === 0">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            Hiểu và phân biệt được âm /[[ phoneme1.ipa_symbol ]]/
                            <span v-if="phoneme2 && phoneme2.ipa_symbol !== phoneme1.ipa_symbol"> và /[[ phoneme2.ipa_symbol ]]/</span>
                        </li>
                        <li class="mb-2" v-if="!lesson.objectives || lesson.objectives.length === 0">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            Luyện tập phát âm với từ vựng thực tế
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- ============================================ -->
        <!-- SCREEN 2: PRACTICE PHONEME 1 -->
        <!-- ============================================ -->
        <div class="screen-container" :class="{ active: currentScreen === 2 }">
            <div class="text-center mb-4">
                <span class="badge px-3 py-2 mb-3" :class="phoneme1.voicing === 'voiceless' ? 'bg-info' : 'bg-warning text-dark'">
                    [[ phoneme1.voicing === 'voiceless' ? 'Âm Vô Thanh (Unvoiced)' : 'Âm Hữu Thanh (Voiced)' ]]
                </span>
                <div class="ipa-symbol-hero">/[[ phoneme1.ipa_symbol ]]/</div>
                <p class="lead mt-2">[[ phoneme1.vietnamese_approx ]]</p>
            </div>
            
            <!-- Tip -->
            <div class="tip-box mb-4" v-if="phoneme1.pronunciation_tips_vi">
                <div class="d-flex align-items-start gap-3">
                    <i class="fas fa-magic mt-1"></i>
                    <div>
                        <h5 class="fw-bold mb-2">Mẹo phát âm</h5>
                        <p class="mb-0">[[ phoneme1.pronunciation_tips_vi ]]</p>
                    </div>
                </div>
            </div>
            
            <!-- Word Flashcards -->
            <h5 class="fw-bold mb-3">
                <i class="fas fa-headphones text-primary me-2"></i>
                Nghe và luyện tập từ vựng
            </h5>
            
            <div class="row g-3 mb-4">
                <div v-for="(word, idx) in phoneme1Words" :key="idx" class="col-6 col-md-4">
                    <div class="word-practice-card" 
                         :class="{ active: activeWord === 'p1_' + idx }"
                         @click="playWord(word, 'p1_' + idx)">
                        <div class="word-text">[[ word.word ]]</div>
                        <div class="word-ipa" v-html="highlightIPA(word.ipa_transcription, phoneme1.ipa_symbol)"></div>
                        <div class="word-meaning">[[ word.meaning_vi ]]</div>
                        <button class="btn btn-sm btn-outline-primary mt-2">
                            <i class="fas fa-volume-up me-1"></i> Nghe
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Common Mistakes -->
            <div v-if="phoneme1.common_mistakes_vi" class="alert alert-warning border-0">
                <i class="fas fa-exclamation-triangle me-2"></i>
                <strong>Lỗi người Việt hay mắc:</strong> [[ phoneme1.common_mistakes_vi ]]
            </div>
        </div>
        
        <!-- ============================================ -->
        <!-- SCREEN 3: PRACTICE PHONEME 2 -->
        <!-- ============================================ -->
        <div class="screen-container" :class="{ active: currentScreen === 3 }">
            <div class="text-center mb-4">
                <span class="badge px-3 py-2 mb-3" :class="phoneme2.voicing === 'voiceless' ? 'bg-info' : 'bg-warning text-dark'">
                    [[ phoneme2.voicing === 'voiceless' ? 'Âm Vô Thanh (Unvoiced)' : 'Âm Hữu Thanh (Voiced)' ]]
                </span>
                <div class="ipa-symbol-hero">/[[ phoneme2.ipa_symbol ]]/</div>
                <p class="lead mt-2">[[ phoneme2.vietnamese_approx ]]</p>
            </div>
            
            <!-- Tip -->
            <div class="tip-box tip-box-primary mb-4" v-if="phoneme2.pronunciation_tips_vi">
                <div class="d-flex align-items-start gap-3">
                    <i class="fas fa-hand-point-up mt-1"></i>
                    <div>
                        <h5 class="fw-bold mb-2">Mẹo phát âm</h5>
                        <p class="mb-0">[[ phoneme2.pronunciation_tips_vi ]]</p>
                    </div>
                </div>
            </div>
            
            <!-- Word Flashcards -->
            <h5 class="fw-bold mb-3">
                <i class="fas fa-headphones text-primary me-2"></i>
                Nghe và luyện tập từ vựng
            </h5>
            
            <div class="row g-3 mb-4">
                <div v-for="(word, idx) in phoneme2Words" :key="idx" class="col-6 col-md-4">
                    <div class="word-practice-card" 
                         :class="{ active: activeWord === 'p2_' + idx }"
                         @click="playWord(word, 'p2_' + idx)">
                        <div class="word-text">[[ word.word ]]</div>
                        <div class="word-ipa" v-html="highlightIPA(word.ipa_transcription, phoneme2.ipa_symbol)"></div>
                        <div class="word-meaning">[[ word.meaning_vi ]]</div>
                        <button class="btn btn-sm btn-outline-warning mt-2">
                            <i class="fas fa-volume-up me-1"></i> Nghe
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Common Mistakes -->
            <div v-if="phoneme2.common_mistakes_vi" class="alert alert-warning border-0">
                <i class="fas fa-exclamation-triangle me-2"></i>
                <strong>Lỗi người Việt hay mắc:</strong> [[ phoneme2.common_mistakes_vi ]]
            </div>
        </div>
        
        <!-- ============================================ -->
        <!-- SCREEN 4: MINIMAL PAIRS CHALLENGE -->
        <!-- ============================================ -->
        <div class="screen-container" :class="{ active: currentScreen === 4 }">
            <div class="text-center mb-4">
                <span class="badge bg-danger px-3 py-2 mb-3">Thử thách phân biệt</span>
                <h2 class="h4 fw-bold">Nghe và chọn từ đúng!</h2>
                <p class="text-muted">Câu [[ currentQuestion + 1 ]] / [[ challengeQuestions.length ]]</p>
            </div>
            
            <!-- Challenge Question -->
            <div class="challenge-question mb-4" v-if="currentChallenge">
                <p class="text-muted mb-4">Bấm nút để nghe âm thanh, sau đó chọn từ bạn nghe được</p>
                
                <button class="challenge-audio-btn mb-4" @click="playChallengeAudio" :class="{ 'playing': isPlayingChallenge }">
                    <i class="fas fa-play" v-if="!isPlayingChallenge"></i>
                    <i class="fas fa-volume-up" v-else></i>
                </button>
                
                <div class="d-flex justify-content-center gap-4 flex-wrap">
                    <button class="choice-btn" 
                            :class="getChoiceClass(currentChallenge.word_1)"
                            @click="selectAnswer(currentChallenge.word_1)"
                            :disabled="hasAnswered">
                        <div>[[ currentChallenge.word_1 ]]</div>
                        <small class="text-muted">/[[ currentChallenge.word_1_ipa ]]/</small>
                    </button>
                    
                    <button class="choice-btn"
                            :class="getChoiceClass(currentChallenge.word_2)"
                            @click="selectAnswer(currentChallenge.word_2)"
                            :disabled="hasAnswered">
                        <div>[[ currentChallenge.word_2 ]]</div>
                        <small class="text-muted">/[[ currentChallenge.word_2_ipa ]]/</small>
                    </button>
                </div>
                
                <!-- Feedback -->
                <div v-if="hasAnswered" class="mt-4">
                    <div v-if="isCorrect" class="alert alert-success border-0">
                        <i class="fas fa-check-circle me-2"></i>
                        <strong>Chính xác!</strong> 
                        <span v-if="currentChallenge.difference_note_vi">[[ currentChallenge.difference_note_vi ]]</span>
                    </div>
                    <div v-else class="alert alert-danger border-0">
                        <i class="fas fa-times-circle me-2"></i>
                        <strong>Chưa đúng!</strong> Đáp án đúng là <strong>"[[ correctAnswer ]]"</strong>.
                        <span v-if="currentChallenge.difference_note_vi">[[ currentChallenge.difference_note_vi ]]</span>
                    </div>
                </div>
            </div>
            
            <!-- No questions fallback -->
            <div v-if="!currentChallenge" class="text-center py-5">
                <i class="fas fa-clipboard-check fa-3x text-muted mb-3"></i>
                <h4>Chưa có câu hỏi cho bài học này</h4>
                <p class="text-muted">Hãy tiếp tục sang phần tổng kết!</p>
            </div>
            
            <!-- Score Progress -->
            <div class="text-center" v-if="answeredCount > 0">
                <span class="badge bg-success fs-6">
                    <i class="fas fa-check me-1"></i> [[ correctCount ]] / [[ answeredCount ]] đúng
                </span>
            </div>
        </div>
        
        <!-- ============================================ -->
        <!-- SCREEN 5: SUMMARY & HOMEWORK -->
        <!-- ============================================ -->
        <div class="screen-container" :class="{ active: currentScreen === 5 }">
            <div class="text-center mb-5">
                <div class="mb-4">
                    <i class="fas fa-trophy text-warning" style="font-size: 4rem;"></i>
                </div>
                <h2 class="display-5 fw-bold text-success mb-3">Tuyệt vời!</h2>
                <p class="lead">Bạn đã hoàn thành bài học này!</p>
            </div>
            
            <!-- Score Circle -->
            <div class="d-flex justify-content-center mb-4">
                <div class="score-circle">
                    <div class="score-number">[[ Math.round(accuracy) ]]%</div>
                    <div class="score-label">Độ chính xác</div>
                </div>
            </div>
            
            <!-- Stats -->
            <div class="row g-3 mb-4">
                <div class="col-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body text-center">
                            <div class="h3 text-primary mb-1">[[ correctCount ]] / [[ challengeQuestions.length || 0 ]]</div>
                            <div class="text-muted small">Câu trả lời đúng</div>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body text-center">
                            <div class="h3 text-success mb-1">[[ timeSpentFormatted ]]</div>
                            <div class="text-muted small">Thời gian học</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- XP Earned -->
            <div class="text-center mb-4">
                <div class="xp-earned">
                    <i class="fas fa-star"></i>
                    +[[ totalXpEarned ]] XP
                </div>
            </div>
            
            <!-- Tongue Twister Challenge -->
            <div v-if="tongueTwister" class="tongue-twister-box mb-4">
                <h5 class="fw-bold mb-2">
                    <i class="fas fa-pepper-hot text-success me-2"></i>
                    Thử thách: Câu xoắn lưỡi
                </h5>
                <p class="tongue-twister-text mb-2">"[[ tongueTwister.text ]]"</p>
                <small class="text-muted">[[ tongueTwister.meaning_vi ]]</small>
                <button class="btn btn-sm btn-success mt-3" @click="playTongueTwister">
                    <i class="fas fa-volume-up me-1"></i> Nghe mẫu
                </button>
            </div>
            
            <!-- Action Buttons -->
            <div class="d-grid gap-2">
                <button class="btn btn-primary btn-lg" @click="completeLesson" :disabled="isCompleting">
                    <span v-if="isCompleting">
                        <i class="fas fa-spinner fa-spin me-2"></i> Đang lưu...
                    </span>
                    <span v-else>
                        <i class="fas fa-check me-2"></i> Hoàn thành bài học
                    </span>
                </button>
                <a href="/pronunciation/" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-2"></i> Quay lại thư viện
                </a>
            </div>
        </div>
        
    </main>
    
    <!-- Lesson Footer -->
    <footer class="lesson-footer">
        <div class="d-flex justify-content-between align-items-center">
            <button class="btn btn-outline-secondary" @click="prevScreen" :disabled="currentScreen === 1">
                <i class="fas fa-arrow-left me-2"></i> Quay lại
            </button>
            
            <div class="screen-dots">
                <div v-for="n in 5" :key="n" 
                     class="screen-dot"
                     :class="{ 
                         active: currentScreen === n,
                         completed: completedScreens.includes(n)
                     }">
                </div>
            </div>
            
            <button class="btn btn-primary" @click="nextScreen" v-if="currentScreen < 5">
                <span v-if="currentScreen === 4 && !hasAnswered && currentChallenge">Trả lời</span>
                <span v-else>Tiếp tục <i class="fas fa-arrow-right ms-2"></i></span>
            </button>
            <div v-else style="width: 100px;"></div>
        </div>
    </footer>
    
</div>

    </main>
    
    <!-- Footer -->
    
<!-- Public Footer - Dark Theme -->
<footer class="site-footer bg-primary-dark text-light py-5">
    <div class="container">
        <div class="row g-4">
            <!-- Brand Column -->
            <div class="col-lg-4 col-md-6 mb-4 mb-lg-0">
                <h3 class="h4 fw-bold mb-4">
                    <span class="text-white">English</span><span class="text-energetic-orange">Master</span>
                </h3>
                <p class="text-light opacity-75 mb-4">
                    Nền tảng học Tiếng Anh trực tuyến hàng đầu Việt Nam. 
                    Phương pháp học tập hiện đại, hiệu quả vượt trội.
                </p>
                <div class="social-links d-flex gap-2">
                    <a href="#" class="btn btn-outline-light btn-sm rounded-circle" style="width:40px;height:40px;display:flex;align-items:center;justify-content:center;" title="Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" class="btn btn-outline-light btn-sm rounded-circle" style="width:40px;height:40px;display:flex;align-items:center;justify-content:center;" title="YouTube">
                        <i class="fab fa-youtube"></i>
                    </a>
                    <a href="#" class="btn btn-outline-light btn-sm rounded-circle" style="width:40px;height:40px;display:flex;align-items:center;justify-content:center;" title="Instagram">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="#" class="btn btn-outline-light btn-sm rounded-circle" style="width:40px;height:40px;display:flex;align-items:center;justify-content:center;" title="LinkedIn">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                </div>
            </div>
            
            <!-- Khóa học -->
            <div class="col-lg-2 col-md-6">
                <h5 class="fw-bold text-white mb-4">Khóa học</h5>
                <ul class="list-unstyled">
                    <li class="mb-2"><a href="/lessons/" class="text-light opacity-75 text-decoration-none hover-orange">Giao tiếp cơ bản</a></li>
                    <li class="mb-2"><a href="/lessons/" class="text-light opacity-75 text-decoration-none hover-orange">Tiếng Anh công sở</a></li>
                    <li class="mb-2"><a href="/lessons/" class="text-light opacity-75 text-decoration-none hover-orange">IELTS</a></li>
                    <li class="mb-2"><a href="/lessons/" class="text-light opacity-75 text-decoration-none hover-orange">TOEIC</a></li>
                </ul>
            </div>
            
            <!-- Về chúng tôi -->
            <div class="col-lg-2 col-md-6">
                <h5 class="fw-bold text-white mb-4">Về chúng tôi</h5>
                <ul class="list-unstyled">
                    <li class="mb-2"><a href="/about/" class="text-light opacity-75 text-decoration-none hover-orange">Giới thiệu</a></li>
                    <li class="mb-2"><a href="/teachers/" class="text-light opacity-75 text-decoration-none hover-orange">Giáo viên</a></li>
                    <li class="mb-2"><a href="/blog/" class="text-light opacity-75 text-decoration-none hover-orange">Blog</a></li>
                    <li class="mb-2"><a href="/careers/" class="text-light opacity-75 text-decoration-none hover-orange">Tuyển dụng</a></li>
                </ul>
            </div>
            
            <!-- Hỗ trợ -->
            <div class="col-lg-2 col-md-6">
                <h5 class="fw-bold text-white mb-4">Hỗ trợ</h5>
                <ul class="list-unstyled">
                    <li class="mb-2"><a href="/help/" class="text-light opacity-75 text-decoration-none hover-orange">Trung tâm trợ giúp</a></li>
                    <li class="mb-2"><a href="/contact/" class="text-light opacity-75 text-decoration-none hover-orange">Liên hệ</a></li>
                    <li class="mb-2"><a href="/privacy/" class="text-light opacity-75 text-decoration-none hover-orange">Chính sách bảo mật</a></li>
                    <li class="mb-2"><a href="/terms/" class="text-light opacity-75 text-decoration-none hover-orange">Điều khoản dịch vụ</a></li>
                </ul>
            </div>
            
            <!-- Liên hệ -->
            <div class="col-lg-2 col-md-6">
                <h5 class="fw-bold text-white mb-4">Liên hệ</h5>
                <ul class="list-unstyled">
                    <li class="mb-3 text-light opacity-75">
                        <i class="fas fa-phone me-2 text-energetic-orange"></i>
                        1900-xxxx
                    </li>
                    <li class="mb-3 text-light opacity-75">
                        <i class="fas fa-envelope me-2 text-energetic-orange"></i>
                        info@englishmaster.vn
                    </li>
                    <li class="mb-3 text-light opacity-75">
                        <i class="fas fa-map-marker-alt me-2 text-energetic-orange"></i>
                        Hà Nội, Việt Nam
                    </li>
                </ul>
            </div>
        </div>
        
        <!-- Bottom Bar -->
        <hr class="my-4 opacity-25">
        <div class="row align-items-center">
            <div class="col-12 text-center">
                <p class="text-light opacity-75 mb-0">
                    © 2025 EnglishMaster. All rights reserved. Made with 
                    <i class="fas fa-heart text-energetic-orange"></i> in Vietnam
                </p>
            </div>
        </div>
    </div>
</footer>

<style>
    .hover-orange:hover {
        color: #F47C26 !important;
        opacity: 1 !important;
    }
    .bg-primary-dark {
        background-color: #183B56 !important;
    }
    .text-energetic-orange {
        color: #F47C26 !important;
    }
</style>

</div>

    
    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Vue.js 3 CDN (Production) -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    
    <!-- Base JS -->
    <script src="/static/js/config.js"></script>
    <script src="/static/js/api.js"></script>
    <script src="/static/js/utils.js"></script>
    
    
<script src="/static/js/auth.js"></script>

<script>
const { createApp } = Vue;

createApp({
    delimiters: ['[[', ']]'],
    
    data() {
        return {
            // Lesson data from server
            lesson: {"id": 1, "slug": "demo-p-b", "title": "The Popping Sounds", "title_vi": "Âm bật hơi /p/ và /b/", "description": "Learn to distinguish voiceless /p/ and voiced /b/", "description_vi": "Học cách phân biệt âm vô thanh /p/ và hữu thanh /b/. Hai âm này có khẩu hình giống nhau nhưng khác nhau ở việc rung thanh quản.", "lesson_type": "pair_contrast", "lesson_content": [], "objectives": ["Hiểu khẩu hình miệng giống nhau của /p/ và /b/", "Phân biệt được sự khác nhau giữa Vô thanh và Hữu thanh", "Luyện tập từ vựng chứa âm /p/ và /b/"], "part_number": 4, "unit_number": 7, "xp_reward": 15, "estimated_minutes": 10, "difficulty": 1},
            phonemes: [{"id": 1, "ipa_symbol": "p", "vietnamese_approx": "pờ (không có âm ờ)", "phoneme_type": "plosive", "voicing": "voiceless", "mouth_position": "Lips pressed together, then released with a puff of air", "mouth_position_vi": "Hai môi mím chặt lại, sau đó bật ra cùng luồng hơi", "tongue_position_vi": "Lưỡi ở vị trí tự nhiên", "pronunciation_tips": "Put a piece of paper in front of your mouth. When you say /p/, the paper should move.", "pronunciation_tips_vi": "Đặt một tờ giấy mỏng trước miệng. Khi phát âm /p/, tờ giấy phải bay lên! Đọc \"pờ\" nhưng KHÔNG có âm \"ờ\". Chỉ bật hơi gió.", "common_mistakes_vi": "Người Việt thường phát âm /p/ quá nhẹ hoặc thêm âm \"ờ\" phía sau.", "example_words": [{"word": "Pen", "ipa_transcription": "/pen/", "meaning_vi": "Cây bút", "phoneme_position": "initial"}, {"word": "Soup", "ipa_transcription": "/suːp/", "meaning_vi": "Súp", "phoneme_position": "final"}, {"word": "Pop", "ipa_transcription": "/pɒp/", "meaning_vi": "Nổ, nhạc Pop", "phoneme_position": "initial"}, {"word": "Apple", "ipa_transcription": "/ˈæpəl/", "meaning_vi": "Quả táo", "phoneme_position": "medial"}, {"word": "Pea", "ipa_transcription": "/piː/", "meaning_vi": "Hạt đậu", "phoneme_position": "initial"}, {"word": "Stop", "ipa_transcription": "/stɒp/", "meaning_vi": "Dừng lại", "phoneme_position": "final"}]}, {"id": 2, "ipa_symbol": "b", "vietnamese_approx": "bờ (nhanh, rung)", "phoneme_type": "plosive", "voicing": "voiced", "mouth_position": "Lips pressed together, then released with vibration", "mouth_position_vi": "Hai môi mím chặt lại, sau đó bật ra cùng độ rung của thanh quản", "tongue_position_vi": "Lưỡi ở vị trí tự nhiên", "pronunciation_tips": "Put your fingers on your throat. When you say /b/, you should feel vibration.", "pronunciation_tips_vi": "Đặt 2 ngón tay lên thanh quản (cổ họng). Nói /b/. Bạn có thấy nó rung như điện thoại không? Đọc \"bờ\" nhanh, dứt khoát.", "common_mistakes_vi": "Người Việt có thể phát âm /b/ quá giống /p/ vì không đủ độ rung.", "example_words": [{"word": "Bad", "ipa_transcription": "/bæd/", "meaning_vi": "Tệ", "phoneme_position": "initial"}, {"word": "Web", "ipa_transcription": "/web/", "meaning_vi": "Mạng lưới", "phoneme_position": "final"}, {"word": "Boat", "ipa_transcription": "/bəʊt/", "meaning_vi": "Con thuyền", "phoneme_position": "initial"}, {"word": "Brother", "ipa_transcription": "/ˈbrʌðər/", "meaning_vi": "Anh/em trai", "phoneme_position": "initial"}, {"word": "Bob", "ipa_transcription": "/bɒb/", "meaning_vi": "Tên Bob", "phoneme_position": "initial"}, {"word": "Cab", "ipa_transcription": "/kæb/", "meaning_vi": "Taxi", "phoneme_position": "final"}]}],
            minimalPairs: [{"id": 1, "word_1": "Pea", "word_1_ipa": "/piː/", "word_1_meaning": "Hạt đậu", "word_2": "Bee", "word_2_ipa": "/biː/", "word_2_meaning": "Con ong", "difference_note_vi": "/p/ là vô thanh (chỉ bật hơi), /b/ là hữu thanh (rung cổ họng).", "difficulty": 1}, {"id": 2, "word_1": "Pop", "word_1_ipa": "/pɒp/", "word_1_meaning": "Tiếng nổ", "word_2": "Bob", "word_2_ipa": "/bɒb/", "word_2_meaning": "Tên Bob", "difference_note_vi": "Cả hai từ có âm đầu và cuối khác nhau. Pop có /p/ vô thanh, Bob có /b/ hữu thanh.", "difficulty": 1}, {"id": 3, "word_1": "Cap", "word_1_ipa": "/kæp/", "word_1_meaning": "Cái mũ", "word_2": "Cab", "word_2_ipa": "/kæb/", "word_2_meaning": "Taxi", "difference_note_vi": "Âm cuối /p/ ngắt rất nhanh. Âm cuối /b/ kéo dài hơn một chút và trầm.", "difficulty": 2}, {"id": 4, "word_1": "Pat", "word_1_ipa": "/pæt/", "word_1_meaning": "Vỗ nhẹ", "word_2": "Bat", "word_2_ipa": "/bæt/", "word_2_meaning": "Con dơi/Gậy bóng chày", "difference_note_vi": "Tập trung vào âm đầu: /p/ chỉ bật hơi, /b/ rung thanh quản.", "difficulty": 1}, {"id": 5, "word_1": "Rope", "word_1_ipa": "/rəʊp/", "word_1_meaning": "Sợi dây", "word_2": "Robe", "word_2_ipa": "/rəʊb/", "word_2_meaning": "Áo choàng", "difference_note_vi": "Chú ý âm cuối: /p/ vô thanh vs /b/ hữu thanh.", "difficulty": 2}],
            tongueTwisters: [],
            userProgress: null,
            
            // Screen navigation
            currentScreen: 1,
            completedScreens: [],
            
            // Phoneme data
            phoneme1: null,
            phoneme2: null,
            phoneme1Words: [],
            phoneme2Words: [],
            
            // Audio state
            activeWord: null,
            isPlaying: false,
            playingPhoneme: null,
            isPlayingChallenge: false,
            
            // Challenge state
            challengeQuestions: [],
            currentQuestion: 0,
            selectedAnswer: null,
            hasAnswered: false,
            isCorrect: false,
            correctAnswer: '',
            correctCount: 0,
            answeredCount: 0,
            
            // Progress & XP
            xpEarned: 0,
            totalXpEarned: 0,
            startTime: Date.now(),
            timeSpent: 0,
            
            // API state
            isCompleting: false,
            csrfToken: 'FwhKDTICf6y7rvvikYAiX6gkYI1yUoa0dxasoOO9x1CsCQZgR1PJ3M7bGxuf3UCB',
        };
    },
    
    computed: {
        progressPercent() {
            return (this.currentScreen / 5) * 100;
        },
        
        accuracy() {
            if (this.answeredCount === 0) return 100;
            return (this.correctCount / this.answeredCount) * 100;
        },
        
        timeSpentFormatted() {
            const seconds = Math.floor((Date.now() - this.startTime) / 1000);
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        },
        
        currentChallenge() {
            return this.challengeQuestions[this.currentQuestion] || null;
        },
        
        tongueTwister() {
            return this.tongueTwisters && this.tongueTwisters.length > 0 ? this.tongueTwisters[0] : null;
        }
    },
    
    mounted() {
        this.initializeLesson();
    },
    
    methods: {
        initializeLesson() {
            // Set phonemes (pair contrast lesson)
            if (this.phonemes && this.phonemes.length >= 2) {
                this.phoneme1 = this.phonemes[0];
                this.phoneme2 = this.phonemes[1];
                this.phoneme1Words = this.phoneme1.example_words || [];
                this.phoneme2Words = this.phoneme2.example_words || [];
            } else if (this.phonemes && this.phonemes.length === 1) {
                this.phoneme1 = this.phonemes[0];
                this.phoneme2 = this.phonemes[0];
                this.phoneme1Words = this.phoneme1.example_words || [];
                this.phoneme2Words = [];
            } else {
                // Default fallback
                this.phoneme1 = { ipa_symbol: 'p', vietnamese_approx: 'pờ', voicing: 'voiceless' };
                this.phoneme2 = { ipa_symbol: 'b', vietnamese_approx: 'bờ', voicing: 'voiced' };
            }
            
            // Setup challenge questions from minimal pairs
            this.setupChallengeQuestions();
            
            // Restore progress if exists
            if (this.userProgress && this.userProgress.current_screen) {
                this.currentScreen = Math.min(this.userProgress.current_screen, 1);
                this.completedScreens = this.userProgress.completed_screens || [];
            }
        },
        
        setupChallengeQuestions() {
            // Create questions from minimal pairs
            if (this.minimalPairs && this.minimalPairs.length > 0) {
                this.challengeQuestions = this.minimalPairs.map(pair => ({
                    ...pair,
                    // Randomly select which word is the correct answer
                    correctWord: Math.random() > 0.5 ? pair.word_1 : pair.word_2
                }));
            } else {
                // Fallback: create from phoneme words
                const allWords = [...(this.phoneme1Words || []), ...(this.phoneme2Words || [])];
                if (allWords.length >= 2) {
                    this.challengeQuestions = allWords.slice(0, Math.min(5, allWords.length)).map((w, idx) => ({
                        word_1: w.word,
                        word_1_ipa: w.ipa_transcription,
                        word_2: allWords[(idx + 1) % allWords.length]?.word || w.word,
                        word_2_ipa: allWords[(idx + 1) % allWords.length]?.ipa_transcription || w.ipa_transcription,
                        correctWord: w.word,
                        difference_note_vi: ''
                    }));
                }
            }
        },
        
        // Navigation
        prevScreen() {
            if (this.currentScreen > 1) {
                this.currentScreen--;
            }
        },
        
        nextScreen() {
            if (this.currentScreen === 4 && !this.hasAnswered && this.currentChallenge) {
                // Must answer challenge first
                return;
            }
            
            // Mark current screen as completed
            if (!this.completedScreens.includes(this.currentScreen)) {
                this.completedScreens.push(this.currentScreen);
                this.saveScreenProgress();
            }
            
            // Move to next question in challenge
            if (this.currentScreen === 4 && this.hasAnswered) {
                if (this.currentQuestion < this.challengeQuestions.length - 1) {
                    this.currentQuestion++;
                    this.resetChallengeState();
                    return;
                } else {
                    // Challenge completed, save results
                    this.saveChallengeResults();
                }
            }
            
            if (this.currentScreen < 5) {
                this.currentScreen++;
                
                // Calculate XP for completing screens
                if (this.currentScreen === 5) {
                    this.totalXpEarned = this.calculateXP();
                }
            }
        },
        
        // Audio playback
        async playPhoneme(phoneme) {
            if (this.isPlaying) return;
            
            this.playingPhoneme = phoneme === this.phoneme1 ? 1 : 2;
            this.isPlaying = true;
            
            try {
                const word = phoneme.example_words?.[0]?.word || phoneme.vietnamese_approx;
                await this.playTTS(word);
            } finally {
                this.isPlaying = false;
                this.playingPhoneme = null;
            }
        },
        
        async playWord(word, key) {
            if (this.isPlaying) return;
            
            this.activeWord = key;
            this.isPlaying = true;
            
            try {
                await this.playTTS(word.word);
            } finally {
                this.isPlaying = false;
                setTimeout(() => { this.activeWord = null; }, 500);
            }
        },
        
        async playChallengeAudio() {
            if (this.isPlayingChallenge || !this.currentChallenge) return;
            
            this.isPlayingChallenge = true;
            try {
                await this.playTTS(this.currentChallenge.correctWord);
            } finally {
                this.isPlayingChallenge = false;
            }
        },
        
        async playTongueTwister() {
            if (this.tongueTwister) {
                await this.playTTS(this.tongueTwister.text, 'en-US-AriaNeural', '-10%');
            }
        },
        
        async playTTS(text, voice = 'en-US-AriaNeural', rate = '+0%') {
            try {
                const response = await fetch('/api/v1/tts/speak/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': this.csrfToken,
                    },
                    body: JSON.stringify({ text, voice, rate })
                });
                
                const data = await response.json();
                
                if (data.success && data.audio_url) {
                    const audio = new Audio(data.audio_url);
                    await audio.play();
                    
                    // Wait for audio to finish
                    await new Promise(resolve => {
                        audio.onended = resolve;
                        audio.onerror = resolve;
                    });
                }
            } catch (error) {
                console.error('TTS error:', error);
                // Fallback to Web Speech API
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                speechSynthesis.speak(utterance);
            }
        },
        
        // Challenge logic
        selectAnswer(word) {
            if (this.hasAnswered) return;
            
            this.selectedAnswer = word;
            this.hasAnswered = true;
            this.answeredCount++;
            
            this.correctAnswer = this.currentChallenge.correctWord;
            this.isCorrect = word === this.correctAnswer;
            
            if (this.isCorrect) {
                this.correctCount++;
                this.xpEarned += 2;
            }
        },
        
        getChoiceClass(word) {
            if (!this.hasAnswered) {
                return this.selectedAnswer === word ? 'selected' : '';
            }
            
            if (word === this.correctAnswer) {
                return 'correct';
            }
            
            if (this.selectedAnswer === word && !this.isCorrect) {
                return 'incorrect';
            }
            
            return '';
        },
        
        resetChallengeState() {
            this.selectedAnswer = null;
            this.hasAnswered = false;
            this.isCorrect = false;
            this.correctAnswer = '';
        },
        
        // IPA highlighting
        highlightIPA(ipa, phonemeSymbol) {
            if (!ipa || !phonemeSymbol) return ipa || '';
            
            // Simple highlight - replace the symbol with highlighted version
            const escaped = phonemeSymbol.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const regex = new RegExp(`(${escaped}:?)`, 'g');
            return ipa.replace(regex, '<span class="highlight">$1</span>');
        },
        
        // XP calculation
        calculateXP() {
            let xp = this.lesson.xp_reward || 15;
            
            // Accuracy bonus (up to 50%)
            if (this.answeredCount > 0) {
                const accuracyBonus = Math.floor(xp * 0.5 * (this.correctCount / this.answeredCount));
                xp += accuracyBonus;
            }
            
            // Completion bonus
            if (this.completedScreens.length >= 4) {
                xp += 5;
            }
            
            return xp;
        },
        
        // API calls
        async saveScreenProgress() {
            try {
                await fetch('/api/v1/pronunciation/progress/screen/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': this.csrfToken,
                    },
                    body: JSON.stringify({
                        lesson_id: this.lesson.id,
                        screen_number: this.currentScreen,
                        data: {
                            time_spent: Math.floor((Date.now() - this.startTime) / 1000)
                        }
                    })
                });
            } catch (error) {
                console.error('Error saving screen progress:', error);
            }
        },
        
        async saveChallengeResults() {
            try {
                await fetch('/api/v1/pronunciation/progress/challenge/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': this.csrfToken,
                    },
                    body: JSON.stringify({
                        lesson_id: this.lesson.id,
                        correct: this.correctCount,
                        total: this.answeredCount,
                        answers: []
                    })
                });
            } catch (error) {
                console.error('Error saving challenge results:', error);
            }
        },
        
        async completeLesson() {
            this.isCompleting = true;
            
            try {
                const response = await fetch('/api/v1/pronunciation/progress/complete/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': this.csrfToken,
                    },
                    body: JSON.stringify({
                        lesson_id: this.lesson.id,
                        time_spent: Math.floor((Date.now() - this.startTime) / 1000)
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Show success and redirect
                    alert(`🎉 Chúc mừng! Bạn đã nhận được ${data.xp_earned} XP!`);
                    window.location.href = '/pronunciation/';
                } else {
                    alert('Có lỗi xảy ra. Vui lòng thử lại.');
                }
            } catch (error) {
                console.error('Error completing lesson:', error);
                // Still redirect on error (demo mode)
                window.location.href = '/pronunciation/';
            } finally {
                this.isCompleting = false;
            }
        }
    }
}).mount('#lessonApp');
</script>




<link rel="stylesheet" href="/static/debug_toolbar/css/print.css" media="print">
<link rel="stylesheet" href="/static/debug_toolbar/css/toolbar.css">


<script type="module" src="/static/debug_toolbar/js/toolbar.js" async></script>

<div id="djDebug" class="djdt-hidden" dir="ltr"
     
     data-request-id="62d77e7fe1ee4a76bc36e71e9210bdfe"
     data-render-panel-url="/__debug__/render_panel/"
     
     
     
     data-sidebar-url="/__debug__/history_sidebar/"
     
     data-default-show="true"
       data-update-on-fetch="False">
  <div class="djdt-hidden" id="djDebugToolbar">
    <ul id="djDebugPanelList">
      <li><a id="djHideToolBarButton" href="#" title="Hide toolbar">Hide »</a></li>
      <li>
        <a id="djToggleThemeButton" href="#" title="Toggle Theme">
          Toggle Theme <svg
  aria-hidden="true"
  class="djdt-hidden theme-auto"
  fill="currentColor"
  viewBox="0 0 32 32"
  version="1.1"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M0 16q0 3.264 1.28 6.24t3.392 5.088 5.12 3.424 6.208 1.248q3.264 0 6.24-1.248t5.088-3.424 3.392-5.088 1.28-6.24-1.28-6.208-3.392-5.12-5.088-3.392-6.24-1.28q-3.264 0-6.208 1.28t-5.12 3.392-3.392 5.12-1.28 6.208zM4 16q0-3.264 1.6-6.016t4.384-4.352 6.016-1.632 6.016 1.632 4.384 4.352 1.6 6.016-1.6 6.048-4.384 4.352-6.016 1.6-6.016-1.6-4.384-4.352-1.6-6.048zM16 26.016q2.72 0 5.024-1.344t3.648-3.648 1.344-5.024-1.344-4.992-3.648-3.648-5.024-1.344v20z"
  ></path>
</svg>
<svg
  aria-hidden="true"
  class="djdt-hidden theme-light"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M12 1.25C12.4142 1.25 12.75 1.58579 12.75 2V4C12.75 4.41421 12.4142 4.75 12 4.75C11.5858 4.75 11.25 4.41421 11.25 4V2C11.25 1.58579 11.5858 1.25 12 1.25ZM3.66865 3.71609C3.94815 3.41039 4.42255 3.38915 4.72825 3.66865L6.95026 5.70024C7.25596 5.97974 7.2772 6.45413 6.9977 6.75983C6.7182 7.06553 6.2438 7.08677 5.9381 6.80727L3.71609 4.77569C3.41039 4.49619 3.38915 4.02179 3.66865 3.71609ZM20.3314 3.71609C20.6109 4.02179 20.5896 4.49619 20.2839 4.77569L18.0619 6.80727C17.7562 7.08677 17.2818 7.06553 17.0023 6.75983C16.7228 6.45413 16.744 5.97974 17.0497 5.70024L19.2718 3.66865C19.5775 3.38915 20.0518 3.41039 20.3314 3.71609ZM12 7.75C9.65279 7.75 7.75 9.65279 7.75 12C7.75 14.3472 9.65279 16.25 12 16.25C14.3472 16.25 16.25 14.3472 16.25 12C16.25 9.65279 14.3472 7.75 12 7.75ZM6.25 12C6.25 8.82436 8.82436 6.25 12 6.25C15.1756 6.25 17.75 8.82436 17.75 12C17.75 15.1756 15.1756 17.75 12 17.75C8.82436 17.75 6.25 15.1756 6.25 12ZM1.25 12C1.25 11.5858 1.58579 11.25 2 11.25H4C4.41421 11.25 4.75 11.5858 4.75 12C4.75 12.4142 4.41421 12.75 4 12.75H2C1.58579 12.75 1.25 12.4142 1.25 12ZM19.25 12C19.25 11.5858 19.5858 11.25 20 11.25H22C22.4142 11.25 22.75 11.5858 22.75 12C22.75 12.4142 22.4142 12.75 22 12.75H20C19.5858 12.75 19.25 12.4142 19.25 12ZM17.0255 17.0252C17.3184 16.7323 17.7933 16.7323 18.0862 17.0252L20.3082 19.2475C20.6011 19.5404 20.601 20.0153 20.3081 20.3082C20.0152 20.6011 19.5403 20.601 19.2475 20.3081L17.0255 18.0858C16.7326 17.7929 16.7326 17.3181 17.0255 17.0252ZM6.97467 17.0253C7.26756 17.3182 7.26756 17.7931 6.97467 18.086L4.75244 20.3082C4.45955 20.6011 3.98468 20.6011 3.69178 20.3082C3.39889 20.0153 3.39889 19.5404 3.69178 19.2476L5.91401 17.0253C6.2069 16.7324 6.68177 16.7324 6.97467 17.0253ZM12 19.25C12.4142 19.25 12.75 19.5858 12.75 20V22C12.75 22.4142 12.4142 22.75 12 22.75C11.5858 22.75 11.25 22.4142 11.25 22V20C11.25 19.5858 11.5858 19.25 12 19.25Z"
    fill="currentColor"
  />
</svg>
<svg
  aria-hidden="true"
  class="djdt-hidden theme-dark"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z"
    stroke="currentColor"
    stroke-width="2"
    stroke-linecap="round"
    stroke-linejoin="round"
  />
</svg>

        </a>
      </li>
      
        

<li id="djdt-HistoryPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtHistoryPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Bản ghi nhớ" class="HistoryPanel">
  
  Bản ghi nhớ
  
    
      <br><small>/pronunciation/lesson/ipa-introduction/</small>
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-VersionsPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtVersionsPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Versions" class="VersionsPanel">
  
  Versions
  
    
      <br><small>Django 5.2.9</small>
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-TimerPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtTimerPanel" checked title="Disable for next and successive requests">
  
    <div class="djdt-contentless">
  
  Giờ
  
    
      <br><small>Total: 203.12ms</small>
    
  
  
    </div>
  
</li>

      
        

<li id="djdt-SettingsPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtSettingsPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Settings from config.settings.development" class="SettingsPanel">
  
  Settings
  
    
      
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-HeadersPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtHeadersPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Headers" class="HeadersPanel">
  
  Headers
  
    
      
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-RequestPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtRequestPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Request" class="RequestPanel">
  
  Request
  
    
      <br><small>PronunciationLessonView</small>
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-SQLPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtSQLPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="SQL queries from 1 connection" class="SQLPanel">
  
  SQL
  
    
      <br><small>1 query in 23.69ms</small>
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-StaticFilesPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtStaticFilesPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Static files (0 found, 8 used)" class="StaticFilesPanel">
  
  Static files
  
    
      <br><small>8 files used</small>
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-TemplatesPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtTemplatesPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Templates (5 rendered)" class="TemplatesPanel">
  
  Templates
  
    
      <br><small>pages/pronunciation_lesson.html</small>
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-AlertsPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtAlertsPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Alerts" class="AlertsPanel">
  
  Alerts
  
    
      
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-CachePanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtCachePanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Cache calls from 1 backend" class="CachePanel">
  
  Cache
  
    
      <br><small>0 calls in 0.00ms</small>
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-SignalsPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtSignalsPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Signals" class="SignalsPanel">
  
  Signals
  
    
      <br><small>50 receivers of 15 signals</small>
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-CommunityPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtCommunityPanel" checked title="Disable for next and successive requests">
  
    <a href="#" title="Community" class="CommunityPanel">
  
  Community
  
    
      
    
  
  
    </a>
  
</li>

      
        

<li id="djdt-RedirectsPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtRedirectsPanel" title="Enable for next and successive requests">
  
    <div class="djdt-contentless djdt-disabled">
  
  Intercept redirects
  
  
    </div>
  
</li>

      
        

<li id="djdt-ProfilingPanel" class="djDebugPanelButton">
  <input type="checkbox" data-cookie="djdtProfilingPanel" title="Enable for next and successive requests">
  
    <div class="djdt-contentless djdt-disabled">
  
  Profiling
  
  
    </div>
  
</li>

      
    </ul>
  </div>
  <div class="djdt-hidden" id="djDebugToolbarHandle">
    <div title="Show toolbar" id="djShowToolBarButton">
      <span id="djShowToolBarD">D</span><span id="djShowToolBarJ">J</span>DT
    </div>
  </div>

  
    


  <div id="HistoryPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Bản ghi nhớ</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    


  <div id="VersionsPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Versions</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    



  
    


  <div id="SettingsPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Settings from config.settings.development</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    


  <div id="HeadersPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Headers</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    


  <div id="RequestPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Request</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    


  <div id="SQLPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>SQL queries from 1 connection</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    


  <div id="StaticFilesPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Static files (0 found, 8 used)</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    


  <div id="TemplatesPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Templates (5 rendered)</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    


  <div id="AlertsPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Alerts</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    


  <div id="CachePanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Cache calls from 1 backend</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    


  <div id="SignalsPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Signals</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    


  <div id="CommunityPanel" class="djdt-panelContent djdt-hidden">
    <div class="djDebugPanelTitle">
      <h3>Community</h3>
      <button type="button" class="djDebugClose">×</button>
    </div>
    <div class="djDebugPanelContent">
      
        <div class="djdt-loader"></div>
        <div class="djdt-scroll"></div>
      
    </div>
  </div>


  
    



  
    



  
  <div id="djDebugWindow" class="djdt-panelContent djdt-hidden"></div>
</div>
</body>
</html>

